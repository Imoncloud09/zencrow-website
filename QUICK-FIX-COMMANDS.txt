# Quick Fix Commands - Run these on EC2

# 1. Install zencrow service
cd /home/ec2-user/zencrow-website
sudo cp deployment/zencrow.service /etc/systemd/system/zencrow.service
sudo sed -i 's|/home/ec2-user/zencrow-website|/home/ec2-user/zencrow-website|g' /etc/systemd/system/zencrow.service
sudo systemctl daemon-reload
sudo systemctl enable zencrow
sudo systemctl start zencrow

# 2. Fix nginx
sudo nginx -t
# If errors, check what's wrong
sudo tail -20 /var/log/nginx/error.log

# Remove default config if it conflicts
sudo rm -f /etc/nginx/conf.d/default.conf

# Copy nginx config
sudo cp deployment/nginx.conf /etc/nginx/conf.d/zencrow.conf
sudo sed -i 's|/home/ec2-user/zencrow-website|/home/ec2-user/zencrow-website|g' /etc/nginx/conf.d/zencrow.conf

# Test nginx config
sudo nginx -t

# Start nginx
sudo systemctl start nginx
sudo systemctl enable nginx

# 3. Verify
sudo systemctl status zencrow
sudo systemctl status nginx
sudo netstat -tlnp | grep -E ':80|:8000'

# 4. Test
curl http://localhost:8000/health
curl http://localhost/health

